"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{15177:function(e,a,t){t.r(a),t.d(a,{ChatList:function(){return ChatList}});var s=t(95802),o=t(82038),l=t(51863),n=t(81936);let i=o.forwardRef((e,a)=>{let{className:t,orientation:o="horizontal",decorative:i=!0,...r}=e;return(0,s.jsx)(l.f,{ref:a,decorative:i,orientation:o,className:(0,n.cn)("shrink-0 bg-border","horizontal"===o?"h-[1px] w-full":"h-full w-[1px]",t),...r})});i.displayName=l.f.displayName;var r=t(73022),c=t(41935),g=t(64491),p=t(23691);function useCopyToClipboard(e){let{timeout:a=2e3}=e,[t,s]=o.useState(!1);return{isCopied:t,copyToClipboard:e=>{var t;(null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText)&&e&&navigator.clipboard.writeText(e).then(()=>{s(!0),setTimeout(()=>{s(!1)},a)})}}}var d=t(14104),u=t(61501);let m={javascript:".js",python:".py",java:".java",c:".c",cpp:".cpp","c++":".cpp","c#":".cs",ruby:".rb",php:".php",swift:".swift","objective-c":".m",kotlin:".kt",typescript:".ts",go:".go",perl:".pl",rust:".rs",scala:".scala",haskell:".hs",lua:".lua",shell:".sh",sql:".sql",html:".html",css:".css"},generateRandomString=function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t="ABCDEFGHJKLMNPQRSTUVWXY3456789",s="";for(let a=0;a<e;a++)s+=t.charAt(Math.floor(Math.random()*t.length));return a?s.toLowerCase():s},h=(0,o.memo)(e=>{let{language:a,value:t}=e,{isCopied:o,copyToClipboard:l}=useCopyToClipboard({timeout:2e3});return(0,s.jsxs)("div",{className:"relative w-full font-sans codeblock bg-zinc-950",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between w-full px-6 py-2 pr-4 bg-zinc-800 text-zinc-100",children:[(0,s.jsx)("span",{className:"text-xs lowercase",children:a}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsxs)(u.z,{variant:"ghost",className:"hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>{let e=m[a]||".file",s="file-".concat(generateRandomString(3,!0)).concat(e),o=window.prompt("Enter file name",s);if(!o)return;let l=new Blob([t],{type:"text/plain"}),n=URL.createObjectURL(l),i=document.createElement("a");i.download=o,i.href=n,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)},size:"icon",children:[(0,s.jsx)(d.IconDownload,{}),(0,s.jsx)("span",{className:"sr-only",children:"Download"})]}),(0,s.jsxs)(u.z,{variant:"ghost",size:"icon",className:"text-xs hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>{o||l(t)},children:[o?(0,s.jsx)(d.IconCheck,{}):(0,s.jsx)(d.IconCopy,{}),(0,s.jsx)("span",{className:"sr-only",children:"Copy code"})]})]})]}),(0,s.jsx)(g.Z,{language:a,style:p.RY,PreTag:"div",showLineNumbers:!0,customStyle:{margin:0,width:"100%",background:"transparent",padding:"1.5rem 1rem"},codeTagProps:{style:{fontSize:"0.9rem",fontFamily:"var(--font-mono)"}},children:t})]})});h.displayName="CodeBlock";var f=t(15709);let x=(0,o.memo)(f.U,(e,a)=>e.children===a.children&&e.className===a.className);var v=t(13988),b=t(91570);function ChatMessage(e){var a,t,l;let{message:i,messageType:g,botImage:p,...m}=e,[f,y]=(0,o.useState)(""),j=(0,o.useRef)(null);if((0,o.useEffect)(()=>{j.current&&f&&(j.current.src=f)},[f]),i&&(i.content.includes("FILE:BB")||i.content.includes("FILE:BB"))){let[e,a,...s]=i.content.split("\n$#$\n");i.data&&(null===(t=i.data)||void 0===t?void 0:t.imageBase64)&&y(null===(l=i.data)||void 0===l?void 0:l.imageBase64),i.content=s.join("")}let speakIt=async(e,a)=>{let t=e.getAttribute("isplaying");if(t){let a=document.getElementById(t);null==a||a.pause(),null==a||a.remove(),e.setAttribute("isplaying","")}else{a=a.toString();let t=(0,b.x0)(),s=await (0,v.jQ)(a),o=document.createElement("audio");o.src=s,o.id=t,o.style.display="none",o.play(),e.setAttribute("isplaying",t),e.append(o)}};return(0,s.jsxs)("div",{className:(0,n.cn)("group relative mb-4 flex items-start md:-ml-12"),...m,children:[(0,s.jsx)("div",{className:(0,n.cn)("flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-md border shadow message-role-icon","user"===i.role?"bg-background":"bg-transparent text-primary-foreground"),children:"user"===i.role?(0,s.jsx)(d.IconUser,{}):p?(0,s.jsx)("img",{src:p,className:"behavior-avatar object-cover",style:{margin:"auto",borderRadius:"calc(var(--radius) - 2px)"}}):(0,s.jsx)(d.IconOpenAI,{})}),(0,s.jsxs)("div",{className:"ml-4 flex-1 space-y-2 overflow-hidden px-1",children:["assistant"===i.role&&(0,s.jsx)("div",{className:"response-speaker",style:{float:"right",display:"none"},onClick:e=>speakIt(e.target,i.content),children:(0,s.jsx)(u.z,{variant:"outline",children:(0,s.jsx)(d.IconSpeaker,{})})}),!(null==j?void 0:null===(a=j.current)||void 0===a?void 0:a.src.includes("data:text/"))&&(0,s.jsx)("img",{ref:j,className:"h-100"}),"spinner"===g?(0,s.jsx)("div",{role:"status",style:{marginTop:0,display:"flex"},children:(0,s.jsx)(d.LoaderIcon,{})}):(0,s.jsx)(x,{className:"prose break-words dark:prose-invert prose-p:leading-relaxed prose-pre:p-0",remarkPlugins:[r.Z,c.Z],components:{p(e){let{children:a}=e;return(0,s.jsx)("p",{className:"mb-2 last:mb-0",children:a})},code(e){let{node:a,className:t,children:o,...l}=e;if(o&&o.constructor===Array&&Object.values(o).length&&"▍"==o[0])return(0,s.jsx)("span",{className:"mt-1 animate-pulse cursor-default",children:"▍"});let n=/language-(\w+)/.exec(t||"");return(null==a?void 0:a.children)&&(null==a?void 0:a.children[0])!=null&&!n&&(null==a?void 0:a.children[0]).position?(0,s.jsx)("code",{className:t,...l,children:o}):(0,s.jsx)(h,{language:n&&n[1]||"",value:String(o).replace(/\n$/,""),...l},Math.random())}},children:i.content})]})]})}var y=t(31561);function FeedbackButtons(e){let{className:a,message:t,userInput:l,messageWithFeedback:n,setMessagesWithFeedback:i,...r}=e,[c]=(0,y._)("userId",null),[g,p]=(0,o.useState)(""),[m,h]=(0,o.useState)(!0),handleClick=async e=>{let a="1"===e?"good":"bad";i({type:a}),p(a),await fetch("/api/feedbackChatResult",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({feedback:e,message:t,userInput:l,messageWithFeedback:n})})};return(0,s.jsx)(s.Fragment,{children:m&&(0,s.jsx)("div",{className:"flex justify-center w-full font-sans",children:(0,s.jsx)("div",{className:"flex w-5/7 items-center justify-between rounded-lg border-slate-600",children:(0,s.jsxs)("div",{className:"flex items-center space-x-1 px-2 py-12",children:[(0,s.jsx)("div",{className:"text-sm text-gray-300",children:"Is this conversation helpful so far?"}),(0,s.jsxs)("div",{className:"flex justify-center",children:[(0,s.jsx)(u.z,{variant:"ghost",size:"icon",className:"text-xs hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>handleClick("1"),children:"good"===g?(0,s.jsx)(d.IconThumbsUpFilled,{}):(0,s.jsx)(d.IconThumbsUp,{})}),(0,s.jsx)(u.z,{variant:"ghost",className:"hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>handleClick("-1"),size:"icon",children:"bad"===g?(0,s.jsx)(d.IconThumbsDownFilled,{}):(0,s.jsx)(d.IconThumbsDown,{})})]})]})})})})}var j=t(63069),w=t(96163);function ChatList(e){let{messages:a,showSprinner:t,isLoading:l}=e,[n,r]=(0,o.useState)([]);if(!a.length)return null;let[c,g]=(0,o.useState)(""),applyBot=async()=>{let e=window.location.href;if(e.includes("/agent/")){let a=await (0,j.y)(e.split("agent/")[1]);a&&a.cover.startsWith("data:image")&&g(a.cover)}else if(e.includes("chat/expert")){let a=e.split("chat/expert-")[1],t=(0,w.H)(a);t&&g(t)}};return(0,o.useEffect)(()=>{applyBot()},[]),(0,s.jsxs)(s.Fragment,{children:[a.map((e,t)=>(0,s.jsxs)("div",{className:"relative mx-auto max-w-2xl px-4",children:[(0,s.jsx)(ChatMessage,{message:e,messageType:"message",botImage:c}),t<a.length-1&&(0,s.jsx)(i,{className:"my-4 md:my-8"}),t%2!=0&&!l&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(FeedbackButtons,{messageWithFeedback:n.find((e,a)=>a===t),setMessagesWithFeedback:e=>{r(a=>{var s;return null!=a&&a.find((e,a)=>a===t)?(null===(s=a.find((e,a)=>a===t))||void 0===s?void 0:s.type)===e.type?a.filter((e,a)=>a!==t):(a[t].type=e.type,[...a]):[...a,{...e,index:t}]})},message:a.at(-1),userInput:a.at(-2)})})]},t)),(0,s.jsx)("div",{className:"relative mx-auto max-w-2xl px-4",children:t&&(0,s.jsx)(ChatMessage,{message:{id:"spinner",content:"",role:"system"},messageType:"spinner",botImage:c})})]})}},63069:function(e,a,t){t.d(a,{y:function(){return getAgent}});let s={};async function getAgent(e){try{let a={};if(s[e])a=s[e];else{let t=await fetch("/api/getagent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});a=await t.json(),s[e]=a}return{name:a.name,cover:a.cover,id:a.id,sysprompt:a.sysprompt,createdAt:a.createdAt}}catch(e){return console.log("getAgent: ",e),{}}}},96163:function(e,a,t){t.d(a,{H:function(){return getTrendingAgentImage}});function getTrendingAgentImage(e){return({codecomment:"https://storage.googleapis.com/a1aa/uploads/codecomment.png",improvecode:"https://storage.googleapis.com/a1aa/uploads/codeimprover.png",explaincode:"https://storage.googleapis.com/a1aa/uploads/codeexplainer.png",mongodb:"https://storage.googleapis.com/a1aa/uploads/mongodb-original.png",python:"https://storage.googleapis.com/a1aa/uploads/python-original.png",html:"https://storage.googleapis.com/a1aa/uploads/html5-original.png",swift:"https://storage.googleapis.com/a1aa/uploads/swift-original.png",javascript:"https://storage.googleapis.com/a1aa/uploads/javascript-original.png",react:"https://storage.googleapis.com/a1aa/uploads/react-original.png",xcode:"https://storage.googleapis.com/a1aa/uploads/xcode-plain.png",pytorch:"https://storage.googleapis.com/a1aa/uploads/pytorch-original.png","next.js":"https://storage.googleapis.com/a1aa/uploads/nextjs-original.png",android:"https://storage.googleapis.com/a1aa/uploads/android-original.png",angularjs:"https://storage.googleapis.com/a1aa/uploads/angularjs-original.png",azure:"https://storage.googleapis.com/a1aa/uploads/azure-original.png",bitbucket:"https://storage.googleapis.com/a1aa/uploads/bitbucket-original.png",digitalocean:"https://storage.googleapis.com/a1aa/uploads/digitalocean-original.png",docker:"https://storage.googleapis.com/a1aa/uploads/docker-plain.png",electron:"https://storage.googleapis.com/a1aa/uploads/electron-original.png",erlang:"https://storage.googleapis.com/a1aa/uploads/erlang-plain.png",fastapi:"https://storage.googleapis.com/a1aa/uploads/fastapi-plain.png",firebase:"https://storage.googleapis.com/a1aa/uploads/firebase-plain.png",flask:"https://storage.googleapis.com/a1aa/uploads/flask-original.png",flutter:"https://storage.googleapis.com/a1aa/uploads/flutter-plain.png",git:"https://storage.googleapis.com/a1aa/uploads/git-plain.png",github:"https://storage.googleapis.com/a1aa/uploads/github-original-logo.png",gitlab:"https://storage.googleapis.com/a1aa/uploads/gitlab-plain.png",go:"https://storage.googleapis.com/a1aa/uploads/go-plain.png",godot:"https://storage.googleapis.com/a1aa/uploads/godot-original.png",googlecloud:"https://storage.googleapis.com/a1aa/uploads/googlecloud-original.png",heroku:"https://storage.googleapis.com/a1aa/uploads/heroku-plain.png",java:"https://storage.googleapis.com/a1aa/uploads/java-plain.png",youtube:"https://storage.googleapis.com/a1aa/uploads/youtube-original.png",steve:"https://storage.googleapis.com/a1aa/uploads/steve-apple.png",elon:"https://storage.googleapis.com/a1aa/uploads/elonmusk.png"})[e.toLocaleLowerCase()]||null}},31561:function(e,a,t){t.d(a,{_:function(){return useLocalStorage}});var s=t(82038);let useLocalStorage=(e,a)=>{let[t,o]=(0,s.useState)(a);return(0,s.useEffect)(()=>{let a=window.location.search,t=new URLSearchParams(a),s=t.get("userId");if(s&&"userId"===e){window.localStorage.setItem(e,JSON.stringify(s)),o(JSON.parse(JSON.stringify(s)));return}let l=window.localStorage.getItem(e);l&&o(JSON.parse(l))},[e]),[t,a=>{o(a);let t=window.location.search,s=new URLSearchParams(t),l=s.get("userId");if(l&&"userId"===e){window.localStorage.setItem(e,JSON.stringify(l));return}window.localStorage.setItem(e,JSON.stringify(a))}]}}}]);